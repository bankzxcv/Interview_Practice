# 12-external-secret-example.yaml
# Example of using External Secrets Operator
# Requires: External Secrets Operator installed
# This is for reference only - won't work without the operator

apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vault-backend
spec:
  provider:
    vault:
      server: "https://vault.example.com"
      path: "secret"
      version: "v2"
      auth:
        tokenSecretRef:
          name: vault-token
          key: token

---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: app-external-secret
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-backend
    kind: SecretStore
  target:
    name: app-secrets-from-vault  # K8s secret to create
    creationPolicy: Owner
  data:
  - secretKey: db-password  # Key in K8s secret
    remoteRef:
      key: myapp/database  # Path in Vault
      property: password   # Property in Vault

# Benefits of External Secrets:
# - Secrets stored in external vault
# - Automatic rotation
# - Centralized secret management
# - Audit trail
# - Better security than K8s secrets alone
